# File: polytopes/build_functions/build_sage_polytopes.py
#
# Contains builder functions for various 3D polytopes available in the
# SageMath standard library (sage.geometry.polyhedron.library.polytopes).
# Each function follows the naming convention 'build_<polytope_name>'
# and returns a tuple: (sage_polyhedron_object, display_name)
#
# Requires: SageMath environment to run generate_jsons.py
# Source: https://doc.sagemath.org/html/en/reference/discrete_geometry/sage/geometry/polyhedron/library.html

try:
    # Import the necessary SageMath library functions
    from sage.geometry.polyhedron.library import polytopes
    # Might need Polyhedron class if constructing manually, but library usually returns it.
    # from sage.all import Polyhedron
except ImportError:
    # This error should ideally be caught by generate_jsons.py,
    # but good practice to anticipate it here too.
    print("ERROR (build_sage_polytopes.py): Could not import SageMath library.")
    print("Ensure this script is used within a SageMath environment.")
    # Define dummy functions if Sage is not available, so generate_jsons can report errors gracefully.
    polytopes = None # Indicate polytopes library is not available

# Helper to prevent errors if Sage isn't loaded when generate_jsons scans
def _placeholder_polytope():
    """Returns None if Sage is not loaded, used as fallback."""
    print("WARNING: Sage library 'polytopes' not loaded. Returning None.")
    return None, "Error: Sage Not Loaded"

# --- Platonic Solids ---

def build_tetrahedron():
    """Builds the standard Tetrahedron."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Tetrahedron()
    name = "Tetrahedron"
    return poly, name

def build_cube():
    """Builds the standard Cube (Hexahedron)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Cube()
    name = "Cube"
    return poly, name

def build_octahedron():
    """Builds the standard Octahedron."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Octahedron()
    name = "Octahedron"
    return poly, name

def build_dodecahedron():
    """Builds the standard Dodecahedron."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Dodecahedron()
    name = "Dodecahedron"
    return poly, name

def build_icosahedron():
    """Builds the standard Icosahedron."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Icosahedron()
    name = "Icosahedron"
    return poly, name

# --- Basic Dimension-Parametric Polytopes (set to 3D) ---

def build_simplex_3d():
    """Builds the 3-dimensional Simplex (geometrically a Tetrahedron)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Simplex(3)
    name = "Simplex (3D)"
    return poly, name

def build_cross_polytope_3d():
    """Builds the 3-dimensional Cross Polytope (geometrically an Octahedron)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.CrossPolytope(3)
    name = "Cross Polytope (3D)"
    return poly, name

# --- Prisms and Antiprisms ---

def build_triangular_prism():
    """Builds a Triangular Prism (RegularPrism(3))."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RegularPrism(3)
    name = "Triangular Prism"
    return poly, name

# Note: RegularPrism(4) is the Cube, already included.

def build_pentagonal_prism():
    """Builds a Pentagonal Prism (RegularPrism(5))."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RegularPrism(5)
    name = "Pentagonal Prism"
    return poly, name

def build_hexagonal_prism():
    """Builds a Hexagonal Prism (RegularPrism(6))."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RegularPrism(6)
    name = "Hexagonal Prism"
    return poly, name

# Note: RegularAntiprism(3) is the Octahedron, already included.

def build_square_antiprism():
    """Builds a Square Antiprism (RegularAntiprism(4))."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RegularAntiprism(4)
    name = "Square Antiprism"
    return poly, name

def build_pentagonal_antiprism():
    """Builds a Pentagonal Antiprism (RegularAntiprism(5))."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RegularAntiprism(5)
    name = "Pentagonal Antiprism"
    return poly, name

# --- Archimedean Solids ---

def build_truncated_tetrahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedTetrahedron()
    name = "Truncated Tetrahedron"
    return poly, name

def build_cuboctahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Cuboctahedron()
    name = "Cuboctahedron"
    return poly, name

def build_truncated_cube():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedCube()
    name = "Truncated Cube"
    return poly, name

def build_truncated_octahedron():
    """Builds the Truncated Octahedron (also the Permutahedron for n=4)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedOctahedron()
    name = "Truncated Octahedron"
    return poly, name

def build_rhombicuboctahedron(): # Small Rhombicuboctahedron
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Rhombicuboctahedron()
    name = "Rhombicuboctahedron (Small)"
    return poly, name

def build_truncated_cuboctahedron(): # Great Rhombicuboctahedron
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedCuboctahedron()
    name = "Truncated Cuboctahedron (Great Rhombicuboctahedron)"
    return poly, name

def build_icosidodecahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Icosidodecahedron()
    name = "Icosidodecahedron"
    return poly, name

def build_truncated_dodecahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedDodecahedron()
    name = "Truncated Dodecahedron"
    return poly, name

def build_truncated_icosahedron(): # Soccer ball
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedIcosahedron()
    name = "Truncated Icosahedron (Soccer Ball)"
    return poly, name

def build_rhombicosidodecahedron(): # Small Rhombicosidodecahedron
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.Rhombicosidodecahedron()
    name = "Rhombicosidodecahedron (Small)"
    return poly, name

def build_truncated_icosidodecahedron(): # Great Rhombicosidodecahedron
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TruncatedIcosidodecahedron()
    name = "Truncated Icosidodecahedron (Great Rhombicosidodecahedron)"
    return poly, name

def build_snub_cube():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.SnubCube()
    name = "Snub Cube"
    return poly, name

def build_snub_dodecahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.SnubDodecahedron()
    name = "Snub Dodecahedron"
    return poly, name

# --- Catalan Solids (Duals of Archimedean) ---

def build_triakis_tetrahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TriakisTetrahedron()
    name = "Triakis Tetrahedron"
    return poly, name

def build_rhombic_dodecahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RhombicDodecahedron()
    name = "Rhombic Dodecahedron"
    return poly, name

def build_triakis_octahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TriakisOctahedron()
    name = "Triakis Octahedron"
    return poly, name

def build_tetrakis_hexahedron(): # Tetrakis Cube
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TetrakisHexahedron()
    name = "Tetrakis Hexahedron (Tetrakis Cube)"
    return poly, name

def build_deltoidal_icositetrahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.DeltoidalIcositetrahedron()
    name = "Deltoidal Icositetrahedron"
    return poly, name

def build_disdyakis_dodecahedron(): # Hexakis Octahedron
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.DisdyakisDodecahedron()
    name = "Disdyakis Dodecahedron (Hexakis Octahedron)"
    return poly, name

def build_pentagonal_icositetrahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.PentagonalIcositetrahedron()
    name = "Pentagonal Icositetrahedron"
    return poly, name

def build_rhombic_triacontahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.RhombicTriacontahedron()
    name = "Rhombic Triacontahedron"
    return poly, name

def build_triakis_icosahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.TriakisIcosahedron()
    name = "Triakis Icosahedron"
    return poly, name

def build_pentakis_dodecahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.PentakisDodecahedron()
    name = "Pentakis Dodecahedron"
    return poly, name

def build_deltoidal_hexecontahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.DeltoidalHexecontahedron()
    name = "Deltoidal Hexecontahedron"
    return poly, name

def build_disdyakis_triacontahedron(): # Hexakis Icosahedron
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.DisdyakisTriacontahedron()
    name = "Disdyakis Triacontahedron (Hexakis Icosahedron)"
    return poly, name

def build_pentagonal_hexecontahedron():
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.PentagonalHexecontahedron()
    name = "Pentagonal Hexecontahedron"
    return poly, name

# --- Johnson Solids (Examples) ---
# There are 92 Johnson solids (J1 to J92). Adding a few examples.

def build_johnson_J1_square_pyramid():
    """Builds Johnson Solid J1 (Square Pyramid)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.JohnsonSolid(1)
    name = "Johnson Solid J1 (Square Pyramid)"
    return poly, name

def build_johnson_J2_pentagonal_pyramid():
    """Builds Johnson Solid J2 (Pentagonal Pyramid)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.JohnsonSolid(2)
    name = "Johnson Solid J2 (Pentagonal Pyramid)"
    return poly, name

def build_johnson_J84_square_cupola():
    """Builds Johnson Solid J4 (Square Cupola)."""
    # J4 is Square Cupola according to Wikipedia/MathWorld. Let's use J4.
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.JohnsonSolid(4) # J4 is Square Cupola
    name = "Johnson Solid J4 (Square Cupola)"
    return poly, name

def build_johnson_J91_bilunabirotunda():
    """Builds Johnson Solid J91 (Bilunabirotunda)."""
    if not polytopes: return _placeholder_polytope()
    poly = polytopes.JohnsonSolid(91)
    name = "Johnson Solid J91 (Bilunabirotunda)"
    return poly, name


# --- Other Named Polytopes (requiring parameter for 3D) ---

def build_associahedron_k4():
    """Builds the 3-dimensional Associahedron (Stasheff Polytope) for k=4."""
    if not polytopes: return _placeholder_polytope()
    # Associahedron(k) is (k-1)-dimensional, so k=4 yields 3D.
    poly = polytopes.Associahedron(4)
    name = "Associahedron (3D, k=4)"
    return poly, name

def build_cyclohedron_k4():
    """Builds the 3-dimensional Cyclohedron for k=4."""
    if not polytopes: return _placeholder_polytope()
    # Cyclohedron(k) is (k-1)-dimensional, so k=4 yields 3D.
    poly = polytopes.Cyclohedron(4)
    name = "Cyclohedron (3D, k=4)"
    return poly, name

def build_permutahedron_n4():
     """Builds the 3-dimensional Permutahedron for n=4 (geometrically a Truncated Octahedron)."""
     if not polytopes: return _placeholder_polytope()
     # Permutahedron(n) is (n-1)-dimensional, so n=4 yields 3D.
     poly = polytopes.Permutahedron(4)
     name = "Permutahedron (3D, n=4)"
     return poly, name

# Note: StasheffPolytope(n) is the same as Associahedron(n).

def build_tesler_polytope_n3():
     """Builds the 3-dimensional Tesler Polytope for n=3."""
     if not polytopes: return _placeholder_polytope()
     # TeslerPolytope(n) has dimension n(n-1)/2. n=3 gives dim 3.
     poly = polytopes.TeslerPolytope(3)
     name = "Tesler Polytope (3D, n=3)"
     return poly, name

# Note: BirkhoffPolytope(n) has dimension (n-1)^2. No integer n yields dimension 3.

# --- END OF BUILD FUNCTIONS ---
